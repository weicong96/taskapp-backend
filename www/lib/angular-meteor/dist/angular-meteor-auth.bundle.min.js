(function(){var Meteor=Package.meteor.Meteor;var _=Package.underscore._;var Tracker=Package.tracker.Tracker;var Deps=Package.tracker.Deps;var Session=Package.session.Session;var Mongo=Package.mongo.Mongo;var EJSON=Package.ejson.EJSON;var check=Package.check.check;var Match=Package.check.Match;var LocalCollection=Package.minimongo.LocalCollection;var Minimongo=Package.minimongo.Minimongo;var ObserveSequence=Package["observe-sequence"].ObserveSequence;var ECMAScript=Package.ecmascript.ECMAScript;var ReactiveVar=Package["reactive-var"].ReactiveVar;var Accounts=Package["accounts-base"].Accounts;var AccountsClient=Package["accounts-base"].AccountsClient;var DiffSequence=Package["diff-sequence"].DiffSequence;var MongoID=Package["mongo-id"].MongoID;var babelHelpers=Package["babel-runtime"].babelHelpers;var Symbol=Package["ecmascript-runtime"].Symbol;var Map=Package["ecmascript-runtime"].Map;var Set=Package["ecmascript-runtime"].Set;var Promise=Package.promise.Promise;(function(){angular.module("angular-meteor.auth",["angular-meteor"])}).call(this);(function(){angular.module("angular-meteor.auth").service("$auth",function($q,$rootScope,$timeout){var AngularMeteorAuthentication=function(){function AngularMeteorAuthentication(){babelHelpers.classCallCheck(this,AngularMeteorAuthentication);this.accountsPackage=Package["accounts-base"];if(!this.accountsPackage){throw new Error("Oops, looks like Accounts-base package is missing! Please add it by running: meteor add accounts-base ")}}AngularMeteorAuthentication.prototype._autorun=function(){function _autorun(fn){var comp=Tracker.autorun(function(c){fn(c);if(!c.firstRun)$timeout(angular.noop,0)});$rootScope.$on("$destroy",function(){comp.stop()});return comp}return _autorun}();AngularMeteorAuthentication.prototype.waitForUser=function(){function waitForUser(){var deferred=$q.defer();this._autorun(function(){if(!Meteor.loggingIn()){deferred.resolve(Meteor.user())}});return deferred.promise}return waitForUser}();AngularMeteorAuthentication.prototype.requireUser=function(){function requireUser(){var deferred=$q.defer();this._autorun(function(){if(!Meteor.loggingIn()){if(Meteor.user()==null){deferred.reject("AUTH_REQUIRED")}else{deferred.resolve(Meteor.user())}}});return deferred.promise}return requireUser}();AngularMeteorAuthentication.prototype.requireValidUser=function(){function requireValidUser(validatorFn){validatorFn=validatorFn||angular.noop;return this.requireUser().then(function(user){var valid=validatorFn(user);if(valid===true){return user}else if(angular.isString(valid)){return $q.reject(valid)}else{return $q.reject("FORBIDDEN")}})}return requireValidUser}();return AngularMeteorAuthentication}();var instance=new AngularMeteorAuthentication;angular.extend(this,Object.getPrototypeOf(instance))}).run(function($auth,$rootScope){$auth._autorun(function(){if(!Meteor.user)return;Object.getPrototypeOf($rootScope).$auth={currentUser:Meteor.user(),currentUserId:Meteor.userId(),loggingIn:Meteor.loggingIn()}})})}).call(this);if(typeof Package==="undefined")Package={};Package["angular-meteor-auth"]={}})();